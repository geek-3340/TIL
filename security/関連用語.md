# 🍪 クッキーとセッションの違いとは？

## はじめに

クッキーとセッションは、**Webアプリで「ユーザーの情報を一時的に覚える」ための仕組み**です。  
でも、保存する「場所」や「使い方」が違います。

---

## 🧁 クッキー（Cookie）とは？

### 🔍 クッキーの説明

**クッキー**は、  
「ユーザーのパソコンやスマホの中に保存される小さなメモ」です。

---

### 📦 例えで説明！

> あなたがパン屋さん（Webサイト）に行ったとき、  
> お店の人が「この人、あんぱん好きだったな」とメモをあなたのカバンに入れてくれます。

この「カバンに入ったメモ」が **クッキー**です。  
次にお店に来たとき、あなたがそのメモを店員に渡せば、「前と同じあんぱん用意しておくね！」となるわけです。

---

### 🛠 どんなときに使う？

- ログイン状態の保存（「次回から自動ログイン」など）
- サイト内の言語設定（日本語か英語か）
- カートに入れた商品情報を一時的に覚える

---

### 🧠 特徴まとめ

| 項目 | 内容 |
|------|------|
| 保存場所 | ユーザーのブラウザ（PCやスマホ） |
| 保存期間 | 設定すれば長く残せる（1週間〜数年も） |
| 安全性 | 自分でも見れてしまうので**あまり重要な情報はNG** |
| 使い方 | 小さな設定や好みを記録するのに便利 |

---

## 🛋️ セッション（Session）とは？

### 🔍 セッションの説明

**セッション**は、  
「サーバー（お店側）に保存される一時的なメモ」です。

---

### 📦 例えで説明！

> 今度はお店の人が「この人、あんぱん好きだったな」というメモを**店の裏の棚（＝サーバー）**に置いておきます。  
> あなたには「このメモの番号は12345です」とだけ伝えます。

次に来たときに「番号12345です」と伝えると、  
店員は裏からメモを持ってきて「前回はあんぱんだったね！」となります。

この仕組みが **セッション**です。

---

### 🛠 どんなときに使う？

- ログイン中のユーザー情報（ID・名前など）
- 一時的にカートに入れている商品
- 会員限定ページへのアクセス管理

---

### 🧠 特徴まとめ

| 項目 | 内容 |
|------|------|
| 保存場所 | サーバー（Webアプリの中） |
| 保存期間 | 通常は「ブラウザを閉じるまで」や「数分〜数時間」 |
| 安全性 | ユーザーから見えないので**重要な情報も保存OK** |
| 使い方 | ログイン情報など、**安全に一時記録したい情報向け** |

---

## 🆚 クッキー vs セッション 比較表

| 比較項目 | クッキー（Cookie） | セッション（Session） |
|-----------|--------------------|------------------------|
| 保存場所 | ユーザーのブラウザ | サーバー側 |
| データの見え方 | ユーザーが中身を見られる | ユーザーは見られない |
| セキ

# 🔐 暗号化とハッシュ化の違いと詳細

## はじめに

インターネットの世界では「情報を守る」ために、  
**暗号化（あんごうか）**と**ハッシュ化**という2つの技術がよく使われます。

でも、目的も使い方もぜんぜん違います！

---

## 🔑 暗号化（Encryption）とは？

### 🔍 簡単に言うと？

> **あとで元に戻せるように、情報を「読めない形に変える」こと**

---

### 📦 例えで説明！

> 手紙を送るとき、**鍵のかかる箱**に入れて送り、  
> 相手だけが持っている「鍵」で開けるようにする。

- 手紙の内容 = **暗号化するデータ**
- 鍵付きの箱 = **暗号化された状態**
- 鍵 = **復号に使うパスワードや秘密鍵**

---

### 🛠 どんなときに使う？

- パスワードを安全に通信する（例：ログイン時）
- メールの内容を見られないようにする
- クレジットカード情報の保護

---

### 📚 種類と仕組み

| 種類 | 特徴 |
|------|------|
| 共通鍵暗号（対称鍵） | 暗号化と復号で**同じ鍵**を使う |
| 公開鍵暗号（非対称鍵） | 暗号化には**公開鍵**、復号には**秘密鍵**を使う |

---

### ✅ 特徴まとめ

- **元のデータに戻すことができる（復号）**
- 安全な通信をしたいときに使う
- 鍵が漏れると危険！

---

## 🧮 ハッシュ化（Hashing）とは？

### 🔍 簡単に言うと？

> **元に戻せない形で、データから「短い文字列（ハッシュ値）」を作ること**

---

### 📦 例えで説明！

> あなたの名前「田中太郎」から、**唯一の記号のような番号（例：abc123）**を作る。  
> この記号は、「田中太郎」からは作れるけど、**abc123から「田中太郎」は絶対に戻せない。**

これが**ハッシュ化**です。

---

### 🛠 どんなときに使う？

- パスワードの保存（中身は覚えない、ハッシュだけ記録）
- データが改ざんされていないかチェック（改ざん検知）
- ファイルの一致チェック（ダウンロード後に壊れてないか）

---

### 📚 代表的なハッシュ関数

- **MD5**（古い、危険）
- **SHA-1**（やや古い、使わない方がいい）
- **SHA-256**（よく使われる）
- **bcrypt**（パスワード保存で特に安全）

---

### ✅ 特徴まとめ

- **元に戻せない（不可逆）**
- 同じ入力 → 同じハッシュ値
- 入力がちょっと違うだけでも全く違う結果
- 他人のパスワードがわからなくても**一致かどうかは判断できる**

---

## 🆚 暗号化とハッシュ化の違い

| 項目 | 暗号化（Encryption） | ハッシュ化（Hashing） |
|------|-----------------------|--------------------------|
| 元に戻せる？ | ✅ 戻せる（復号できる） | ❌ 戻せない（不可逆） |
| 主な目的 | 情報を隠して**後で読む** | 情報が**正しいか確かめる** |
| 使用例 | メール、通信、クレカ情報 | パスワード保存、改ざんチェック |
| 鍵の有無 | 🔑 必要（共通鍵・公開鍵） | 🔑 鍵は使わない |
| 出力の特徴 | 何度やっても違う結果（鍵で変化） | 同じ入力 → 常に同じ出力 |

---

## 💡 高校生向け覚え方！

| 用語 | 例え | ポイント |
|------|------|----------|
| 暗号化 | 鍵付きの箱に入れて送る | あとで元に戻せる |
| ハッシュ化 | 名前 → 番号に変換 | 戻せないけど比較できる |

---

## 🔒 パスワードに関する実践例

### ❌ 悪い例（暗号化だけで保存）

```php
// データベースにパスワードを暗号化して保存（鍵を盗まれると危険）
$encrypted = encrypt('mypassword');
```

### ✅ 良い例（ハッシュ化して保存）

```php
// ハッシュ化して保存（元には戻せない）
$hashed = password_hash('mypassword', PASSWORD_BCRYPT);
```

そしてログイン時にこう比較：

```php
if (password_verify('mypassword', $hashed)) {
    // 正しいパスワード
}
```

---

## ✅ まとめ

- 🔐 **暗号化**は「あとで読むために安全に隠す」
- 🔢 **ハッシュ化**は「チェック用に変換して戻せないようにする」

どちらも情報セキュリティの基本中の基本です！
この2つは混同されやすいですが、
**「あとで戻す必要があるかどうか」** を判断基準にすると理解しやすいです。

# 💬 プリペアドステートメント（バインディング）とは？

## 🔍 ざっくり説明

**プリペアドステートメント**とは：

> **データベースにクエリ（命令）を安全に送る方法**  
> ユーザーが入力した値を、**変数として後からセットする**ことで、  
> セキュリティ（特にSQLインジェクション）を高める仕組み！

---

## 🍜 ラーメン屋さんの例で説明

ラーメン屋さんの注文用紙にこう書かれてるとします：

```
注文：◯◯ラーメン　トッピング：◯◯
```

店員さんは紙の「◯◯」のところに、「しょうゆ」「チャーシュー」などをあとから書き入れる。  
この「◯◯」のところが**バインディングされる変数**です。

---

## 💥 なぜ必要なの？

ユーザーが入力する内容をそのままSQL文に入れてしまうと…

```sql
SELECT * FROM users WHERE name = '$name';
```

例えば、`$name` に悪意ある値が入っていたら：

```sql
' OR '1'='1
```

結果こうなる：

```sql
SELECT * FROM users WHERE name = '' OR '1'='1';
```

これだと**全てのユーザー情報が取得されてしまう！**  
こういった攻撃を「**SQLインジェクション**」と言います。

---

## 🛡 プリペアドステートメントで安全に！

プリペアドステートメントを使えば、  
ユーザーの入力は「ただの値」として扱われるので、命令としては動きません。

### ✅ 例（PHP＋PDO）

```php
$stmt = $pdo->prepare("SELECT * FROM users WHERE name = :name");
$stmt->bindParam(':name', $name);
$stmt->execute();
```

- `:name` が変数の部分（これが**プレースホルダー**）
- `bindParam()` でそこに実際の値を入れる（これが**バインディング**）

---

## 🍰 Laravelでの例（クエリビルダ）

Laravelでは、バインディングは自動でやってくれることが多い！

```php
DB::select("SELECT * FROM users WHERE name = ?", [$name]);
```

または、もっと簡単に：

```php
User::where('name', $name)->get();
```

Laravelが裏でプリペアドステートメントを使ってくれるので安全！

---

## ✅ まとめ

| 項目 | 内容 |
|------|------|
| プリペアドステートメント | SQL文をあらかじめ作っておき、あとから変数をセットする方法 |
| バインディング | 変数の値をSQL文に安全に埋め込むこと |
| メリット | SQLインジェクションを防げる、安全で正確な検索ができる |
| Laravel | クエリビルダやEloquentが自動で安全なバインディングをしてくれる |

---

## 💡 高校生向け覚え方

> 🔒「変数はあとで安全に入れる」ことで、  
> 💣「爆弾（攻撃）」を中に仕込まれないようにする！

# 🔑 トークン・CSRFトークンとは？

---

## 🧩 トークンとは？

**トークン**は、簡単に言うと「**合言葉のようなもの**」です。  
アプリやサービスが、あなたが**正しい人かどうかを判断するために使う文字列（記号の組み合わせ）**です。

---

### 🎮 例：ゲームセンターのコイン

- ゲームセンターで使う「専用コイン」は、店が発行したものだけ有効。
- 他の店のコインを使おうとしても、受け付けてくれない。

→ この「専用コイン」が**トークン**のようなもの！

---

### 💡 トークンの役割

| 目的 | 内容 |
|------|------|
| 認証 | この人はログイン済みかどうか確認する |
| 保護 | 悪い人が勝手に操作するのを防ぐ |

---

## 🛡 CSRFトークンとは？

**CSRFトークン（シーサーフ・トークン）**は、  
**悪意ある攻撃（CSRF攻撃）からフォームを守るためのトークン**です。

---

### ❗ CSRF攻撃とは？

「**ログイン中のユーザーに、知らないうちに操作をさせる**」攻撃です。

#### 📦 例：Amazon風の偽サイト

1. あなたがAmazonにログインしたままの状態で…
2. 悪い人が作った偽の「注文ボタン」を押すと…
3. 実はそれがAmazonの注文APIにアクセスしてて…
4. 意図しない商品が勝手に注文される！

→ これが「**CSRF（クロスサイト・リクエスト・フォージェリ）攻撃**」です。

---

### 🛡 それを防ぐのが CSRFトークン！

1. サーバーは、フォームを表示するときに「**秘密の合言葉（トークン）**」を埋め込む
2. ユーザーが送信したときにそのトークンを確認
3. 合ってなければ「不正なリクエスト」として拒否！

---

## ✅ LaravelでのCSRFトークン対策

Laravelでは、フォームを使うときに自動でCSRFトークンが入るようになっています。

### 🧾 Bladeテンプレートでの例：

```blade
<form method="POST" action="/submit">
    @csrf
    <input type="text" name="message">
    <button type="submit">送信</button>
</form>
```

- `@csrf` これが大事！
- これを書くと、自動で `<input type="hidden" name="_token" value="...">` が追加されます。

---

## 📌 まとめ

| 用語 | 意味 |
|------|------|
| トークン | 合言葉のようなランダムな文字列。本人確認や保護に使われる |
| CSRFトークン | フォーム送信のときに「これは本物のユーザーの操作だよ」と証明するトークン |
| Laravelでの対策 | `@csrf` をフォームに書くことで、自動的に安全になる |

---

## 💡 高校生向け覚え方

> トークン＝本人しか持っていない「鍵」や「合言葉」  
> CSRFトークン＝フォームごとの「ワンタイム合言葉」！
